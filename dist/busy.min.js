angular.module("mnBusy",[]).factory("busyTrackerFactory",["$timeout","$q",function(a,b){return function(){var c={};return c.delayPromise=null,c.durationPromise=null,c.processingPromise=null,c.reset=function(d){var e=[];angular.forEach(d.promises,function(a){a&&"undefined"!=typeof a.then&&-1===e.indexOf(a)&&e.push(a)}),0!==e.length&&(d.delay&&(c.delayPromise=a(function(){c.delayPromise=null},parseInt(d.delay,10))),d.minDuration&&(c.durationPromise=a(function(){c.durationPromise=null},parseInt(d.minDuration,10)+(d.delay?parseInt(d.delay,10):0))),c.processingPromise=b.all(e).then(function(){d.onReadyFn&&d.onReadyFn(),c.processingPromise=null},function(){c.processingPromise=null}))},c.isBusy=function(){return null===c.delayPromise&&(null!==c.durationPromise||null!==c.processingPromise)},c.isActive=function(){return null!==c.processingPromise},c}}]).directive("busyTracker",["$injector","busyTrackerFactory",function(a,b){var c=function(b){var c={},d="busyDefaults";a.has(d)&&angular.extend(c,a.get(d));var e=b.busyConfig;if(e){var f=d+e.charAt(0).toUpperCase();a.has(f)&&angular.extend(c,a.get(f))}var g=b.busyReady;return g&&(c.onReadyExp=g),c},d=function(a){var b,c={},d="busyParam";for(b in a)if(-1!==b.indexOf(d)){var e=b.substr(d.length).toLowerCase();c[e]=a[b]}return c};return{restrict:"A",scope:!0,transclude:!0,templateUrl:function(a,b){return c(b).templateUrl},link:function(a,e,f){a.$tracker=b(),a.$config=c(f),a.$params=d(f),a.$watchCollection(f.busyTracker,function(b){angular.isArray(b)||(b=[b]),!a.$tracker.isActive()&&b.length>0&&a.$tracker.reset({promises:b,delay:a.$config.delay,minDuration:a.$config.minDuration,onReadyFn:a.$config.onReadyExp?function(){a.$eval(a.$config.onReadyExp)}:null})},!0)}}}]).value("busyDefaults",{delay:200,minDuration:500}).value("busyDefaultsButton",{templateUrl:"mnBusy/button.html"}).value("busyDefaultsOverlay",{templateUrl:"mnBusy/overlay.html"}),angular.module("mnBusy").run(["$templateCache",function(a){"use strict";a.put("mnBusy/button.html",'<div><div ng-if="$tracker.isBusy()"><span class="glyphicon glyphicon-refresh glyphicon-spin"></span> {{$params.message}}</div><div ng-if="!$tracker.isBusy()"><div ng-transclude></div></div></div>'),a.put("mnBusy/overlay.html",'<div class="busy-overlay-container"><div ng-if="$tracker.isBusy()"><span class="glyphicon glyphicon-refresh glyphicon-spin busy-overlay-sign"></span><div class="busy-overlay-backdrop"></div></div><div ng-transclude></div></div>')}]);